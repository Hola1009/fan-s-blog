[[网络连接]]就是为了相互通信, 就是网络世界通信, 那么在网络世界中如何判断谁是谁呢, 有没有网络身份证捏~🤨
如何判断到底是从哪台主机，将数据传输到那台主机呢？这就需要使用IP地址来标识。
# IP地址
## 概念
IP地址主要用于标识网络主机、其他网络设备（如路由器）的`网络地址`。简单说，IP地址用于定位主机
就像发快递一样得有地址才能进行数据, 不然光有数据谁知道往哪发啊?🙈

## 格式
IP地址是一个32位的二进制数，通常被分割为4个“8位二进制数”（也就是4个字节），
如：
```
01100100.00000100.00000101.00000110
```

是不是没见过, 因为我们看到的一般都是它的`点分十进制`
```
255.255.255.255
```
挺眼熟是啵👀

## 特殊ip
用于本机访问本机的ip: 环回ip
```
127.0.0.1
```
所有主机的环回ip都是一样一样的

---

# 端口号
光区分主机还不够, 网络传输中还知道通信是主机上的哪个进程在进行
> 就像, 一个宿舍楼, 大家都住在一个地方, 快递地址一样, 但还得区分是谁买的吧

所以呢, 就要用端口号去进行区分, 给每个进程分一个端口号, 就不会冲突了
> [!question] 有了IP地址和端口号，可以定位到网络中唯一的一个进程，但还存在一个问题，网络通信是基于二进制0/1数据来传输，如何告诉对方发送的数据是什么样的呢？

得双方约定一个协议才能正常进行通信吧
不然可能会出现: 我想买的是斯达康, 卖家却给我发个鸡蛋汤
![[Pasted image 20231209224900.png|300]]
基于网络数据传输，就需要使用协议来规定双方的数据格式。

# 认识协议
## 概念
网络协议, 是所有入网的设备都要遵守的一组协议 规则. 如何建立连接, 怎样相互识别等, 只有遵守这个约定, 计算机之间才能相互通信交流
一般由三要素组成:
1. 语法: 即数据的结构或格式
    可以类比成人类语言的语法, 双方得用同样的语言同样的语法才能沟通
2. 语义: 即需要发出何种控制信息，完成何种动作以及做出何种响应；
	比如:	
```
	胡老板: 爱你孤身走暗巷
	小学生: 爱你不跪的模样
	🎵🎵🎵🎵🎵🎵🎵🎵
```
3. 时序: 即事件实现顺序的详细说明。
	时序定义了何时进行通信，先讲什么，后讲什么，讲话的速度等。比如是采用同步传输还是
	异步传输。

> [!tip] 协议最终体现在网络上传输的数据包的格式

# 作用
## 为什么需要协议？

比如, 和网友线下面基, 我约定都戴黑色鸭舌帽, 手捧鲜花, 这是一种提前的约定, 也就是协议
计算机之间的传输媒介是光信号和电信号。通过 "频率" 和 "强弱" 来表示 0 和 1 这样的信息。要想传递
各种不同的信息，就需要约定好双方的数据格式。

- 计算机的品牌, 系统, 硬件五花八门
- 如何让这些不同厂商之间生产的计算机能够相互顺畅的通信? 就需要有人站出来，约定一个
   共同的标准，大家都来遵守，这就是 网络协议；

> [!info] 协议 最终体现在网络上传输的数据包的格式

## 知名协议的默认端口
系统端口号范围为 0 ~ 65535，其中：0 ~ 1023 为知名端口号，这些端口预留给服务端程序绑定广泛使
用的应用层协议，如：
22端口：预留给SSH服务器绑定SSH协议
21端口：预留给FTP服务器绑定FTP协议
23端口：预留给Telnet服务器绑定Telnet协议
80端口：预留给HTTP服务器绑定HTTP协议
443端口：预留给HTTPS服务器绑定HTTPS协议

> [!info] 这些知名端口不一定非得在 `0 ~ 1023`

> 餐厅的VIP包房是给会员使用，但会员也可以不坐包房，坐其他普通座位。

# 五元组
在TCP/IP协议中, 用五元组来标识`一个`网络通信

1. 源IP: 发送方主机
2. 源端口号: 发送方进程
3. 目的IP: 接收方主机
4. 目的端口号: 接收方进程
5. 协议号：标识发送进程和接收进程双方约定的数据格式
![[五元组|500]]
如果愿意的化, 可以类比理解这个过程为快递, 确实很像, 而ip是地址, 端口号是谁谁谁, 而协议就是快递公司

可以在cmd中，输入 `netstat -ano` 查看网络数据传输中的五元组信息：
![[Pasted image 20231210214325.png|600]]

# 协议分层
对于网络协议来说，往往分成几个层次进行定义。
什么是协议分层
协议分层类似于打电话时，定义不同的层次的协议：
![[Pasted image 20231210214516.png|600]]
不同的层次用不同的协议 这样可以方便上层协议使用下层协议
像, 上图中打电话的人不需要知道电话的工作原理, 用的是什么协议, 拿来就就行了---> `拿来主义好, 拿来主义香`
在这个例子中，我们的协议只有两层；但是实际的网络通信会更加复杂，需要分更多的层次。

## 分层的作用
一层一层的去分开不同的业务, 逻辑感很清晰, 让人更方便理解
为什么需要网络协议分层?
这就好像电视节厂商, 制造完电视机后, 不需要把电视机具体怎么工作的, 告诉顾客, 只需要集成出来几个按钮, 告诉客户怎么用按钮操纵电视即可, 这样客户和厂商都省力
是不是很类似于接口式编程, 在java的jdbc(电视)中的接口(电视按钮), 已近交给数据库厂商实现了, 咱们只要导库, 使用即可 根本不用管它是咋实现的

- 对于使用方来说，并不关心提供方是如何实现的，只需要使用接口即可
- 对于提供方来说，利用封装的特性，隐藏了实现的细节，只需要开放接口即可

![[这样能更好的扩展和维护|200]]
这样能更好的扩展和维护: 不同品牌的电视按钮(接口)都一样, 电视坏了不影响我换个电视用按之前的使用按钮的方法继续使用
![[Pasted image 20231210220333.png|300]]


# TCP/IP五层（或四层）模型

TCP/IP是一组协议的代名词，它还包括许多协议，组成了TCP/IP协议簇。
TCP/IP通讯协议采用了5层的层级结构，每一层都呼叫它的下一层所提供的网络来完成自己的需求

- **应用层** :` 负责应用程序间沟通`，如简单电子邮件传输（SMTP）、文件传输协议（FTP）、网络远
程访问协议（Telnet）等。我们的网络编程主要就是针对应用层
- **传输层** : `负责两台主机之间的数据传输。`如传输控制协议 (TCP)，能够确保数据可靠的从源主机发
送到目标主机。
- **网络层** :  `负责地址管理和路由选择。`例如在IP协议中，通过IP地址来标识一台主机，并通过路由表
的方式规划出两台主机之间的数据传输的线路（路由）。路由器（Router）工作在网路层。
- **数据链路层** : `负责设备之间的数据帧的传送和识别。`例如网卡设备的驱动、帧同步(就是说从网线
上检测到什么信号算作新帧的开始)、冲突检测(如果检测到冲突就自动重发)、数据差错校验等工
作。有以太网、令牌环网，无线LAN等标准。交换机（Switch）工作在数据链路层。
- **物理层** :  负责光/电信号的传递方式。比如现在以太网通用的网线(双绞 线)、早期以太网采用的的
同轴电缆(现在主要用于有线电视)、光纤，现在的wifi无线网使用电磁波等都属于物理层的概念。
物理层的能力决定了最大传输速率、传输距离、抗干扰性等。集线器（Hub）工作在物理层。

![[Pasted image 20231210221139.png|500]]

## 网络设备所在分层

- 对于一台**主机**,它的**操作系统**内核实现了从传输层道物理层的内容, 也就是TCP/IP五层模型的**下四层**;
- 对于一台**路由器**, 它实现了网络层到物理层, 也就是TCP/IP五层协议的**下三层**
- 对于一台**交换机**, 它实现了丛数据链路层到物理层, 也即使TCP/IP五层模型的下面两层
- 对于集线器, 它只实现了物理层

## 网络分层对应
网络数据传输时，经过不同的网络节点（主机、路由器）时，网络分层需要对应。
以下为同一个网段内的两台主机进行文件传输：
![[Pasted image 20231211153048.png|400]]
两台计算机通过TCP/IP协议通讯的过程如下:
![[两台计算机通过TCPIP协议通讯的过程]]

## 封装和分用

- 不同的协议层对数据包有不同的称谓，在传输层叫做段(segment)，在网络层叫做数据报
(datagram)，在链路层叫做帧(frame)。
- 应用层数据通过协议栈发到网络上时，每层协议都要加上一个数据首部(header)，称为封装
(Encapsulation)。
- 首部信息中包含了一些类似于首部有多长，载荷(payload)有多长，上层协议是什么等信息。
- 数据封装成帧后发到传输介质上，到达目的主机后每层协议再剥掉相应的首部，根据首部中
的 "上层协议字段" 将数据交给对应的上层协议处理。

下图为数据封装的过程:
![[Pasted image 20231211154749.png|600]]

下图为数据分用的过程:
![[Pasted image 20231211154822.png|600]]