### Http
第一步就是解析URL 解析完后就根据这些信息来生成HTTP请求信息
- 让我们来看看看下URL中元素的组成: 数据协议 + 服务器  (+ 名录名 + 文件名) , 简单来看就是文件在互联网中的位置


### 真实地址查询 -- DNS
之后就是url中的服务器域名来查询服务器的ip地址, 然后再拜托操作系统帮我们发送信给服务器
#### 怎么查呢?
到根据域名到DNS服务器去查, DNS服务器不是一个服务器, 查询ip地址是根据域名一级一级的查的
比如查询 \www.server.com. 的地址
他会先后到 . 根DNS服务器去查, 然后根服务器告诉说.com服务器在哪, 让去那查;  到了.com 顶级域名服务器 又说到server.com 去查; 到了 server.com 权威dns服务器, ip地址就被查到了
因为会有缓存这个东西, 所以上面的流程不是每次请求都会进行

### 协议栈
得到ip后, 就会把发送http请求的工作交给协议栈 , 协议栈上面一层是TCP DUP 协议, 下面一层是IP协议

### TCP
HTTP 是基于TCP传输的 , 到TCP这一层会给应用层传下来的数据加上TCP报头 , 再向下传给IP协议
#### TCP报头里有啥?
- 源端口号   
- 目标端口号   
- 包的序号 -- 用来确认包的顺序
- 确认号 -- 解决丢包问题的
- 状态码 例如 `SYN` 是发起一个连接，`ACK` 是回复，`RST` 是重新连接，`FIN` 是结束连接等。TCP 是面向连接的，因而双方要维护连接的状态，这些带状态位的包的发送，会引起双方的状态变更。
- 窗口大小 -- 用来做流量控制的

> TCP 传输数据之前, 要先进行三次握手建立连接

为了保证通信双发都用数据收发能力, 首先客户端先发送syn的请求连接, 然后服务端将syn + ack一起返回给客户端, 然后客户端再返回一个ack.

> TCP 分割数据

如果 HTTP 请求消息比较长，超过了 `MSS` 的长度，这时 TCP 就需要把 HTTP 的数据拆解成一块块的数据发送，而不是一次性发送所有数据。

### IP协议
TCP封装好的数据报后 , 就会传给下上一层的IP协议让其来完成进一步的打包后在发出去
#### IP报头有啥
需要有源ip和目标ip地址 还有TCP的协议号

### MAC
生成 IP 头部之后 , 接下来网络包还需要再ip头部的前面加上mac头部

mac头部就是以太网使用的头部, 它包含了接受方和发送方的mac地址 还有协议信息

#### 怎么获取接受方mac地址
先查路由表, 找到匹配的条目, 再打包发给对应的路由器
如果没查到, 就以以太网广播的方式去问, 如果目标ip和源ip在一个子网下这时就可以查到对方的mac地址
如果还没有就发给下一个路由器



